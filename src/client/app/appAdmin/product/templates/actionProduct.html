<div spinner-loading="vm.cache.spinnerLoading">
  <md-content layout-padding>
    <form name="actionProductForm">
      <md-input-container class="md-block">
        <label>Name Product</label>
        <input md-maxlength="30" required name="name" ng-model="vm.cache.currentProduct.name">
        <div ng-messages="actionProductForm.name.$error">
          <div ng-message="required">This is required.</div>
          <div ng-message="md-maxlength">The name has to be less than 30 characters long.</div>
        </div>
      </md-input-container>
      <md-input-container class="md-block">
        <label>Price</label>
        <input required name="price" ng-model="vm.cache.currentProduct.price" type="number" step="0.1">
        <div ng-messages="actionProductForm.price.$error">
          <div ng-message="required">This is required and it must be number.</div>
        </div>
      </md-input-container>

      <md-input-container class="md-block">
        <label>Rate (rate >= 0 and rate <= 5)</label>
        <input name="rate" ng-model="vm.cache.currentProduct.rate" type="number" step="1" min="0" max="5">
      </md-input-container>
      <md-input-container class="md-block">
        <label>Quantity</label>
        <input required name="quantity" ng-model="vm.cache.currentProduct.quantity" type="number" step="1">
        <div ng-messages="actionProductForm.quantity.$error">
          <div ng-message="required">This is required and it must be number.</div>
        </div>
      </md-input-container>

      <md-input-container class="md-block">
        <label>Category</label>
        <md-select required name="category" ng-model="vm.cache.currentProduct.category">
          <md-option ng-value="category.id" ng-repeat="category in vm.cache.categoryList">{{category.name}}</md-option>
        </md-select>
        <div class="errors" ng-messages="actionProductForm.category.$error" ng-if="actionProductForm.$dirty">
          <div ng-message="required">This is required.</div>
        </div>
      </md-input-container>

      <md-input-container class="md-block">
        <label>Image Url</label>
        <input required name="imageUrl" ng-model="vm.cache.currentProduct.imageUrl">
        <div ng-messages="actionProductForm.imageUrl.$error">
          <div ng-message="required">This is required.</div>
        </div>
      </md-input-container>

      <div class="box-choose-and-upload-image">
        <label>Image Source</label>
        <input type="file" name="imageSource" file-model="vm.myFile"
               image-with-preview ng-model="vm.imageSource"
               accept="image/jpeg,image/png" class="btn btn-primary"
               dimensions=""
            >
        <span class="error-text" ng-show="actionProductForm.imageSource.$error.imageSource">
          Not a JPEG or a PNG!
        </span>
        <span class="error-text" ng-show="actionProductForm.imageSource.$error.dimensions">
          Image height should be smaller than 400!
        </span>
        <div ng-show="vm.imageSource.src">
          <img ng-src="{{vm.imageSource.src}}" class="show-image-preview"/>
          <md-button class="md-raised md-primary" ng-click="vm.uploadImageToServer(vm.myFile)">Upload</md-button>
        </div>
      </div>

      <div class="md-block">
        <label>Description</label>
        <div ckeditor="vm.optionsEditor" ng-model="vm.cache.descriptionForProduct" ready="vm.onReady()"></div>
      </div>

    </form>

    <div class="pull-right">
      <md-button class="md-raised md-primary" ng-disabled="!actionProductForm.$valid"
                 ng-click="vm.addProduct(vm.cache.currentProduct)"
                 ng-if="vm.cache.currentView.name === 'add'"
        >
        Add
      </md-button>
      <md-button class="md-raised md-primary" ng-disabled="!actionProductForm.$valid"
                 ng-click="vm.updateProduct(vm.cache.currentProduct)"
                 ng-if="vm.cache.currentView.name === 'edit'"
        >
        Update
      </md-button>
      <md-button class="md-raised" ng-click="vm.backToTableView()">Cancer</md-button>
    </div>
  </md-content>
</div>